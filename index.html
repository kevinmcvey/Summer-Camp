<!--
  TODO
    1. Outro
    2. Music (pls)
    3. Allow for pausing:
        - Better window focus check than jQuery on focus / blur (doesn't start timer automatically or recognize first blur)
        - Move event recorders over to Timer instead of system time
        - Trigger events based upon Timer ticks instead of pre-scheduled setTimeouts
    4. Fade should be piecewise: no fade for 50% of the "day", then fade out.
    5. Indicate when the user is no longer in control.

  CLEANUP
    1. Everything should set directly to prototype, not overwrite it
    2. Layer and cover should inherit from a common parent
-->
<html>
    <head>
        <title>Another day at summer camp</title>
        <link href='https://fonts.googleapis.com/css?family=Raleway:200,100' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" type="text/css" href="style.css">
        <script type="text/javascript" src="src/Util.js"></script>
        <script type="text/javascript" src="src/CanvasController.js"></script>
        <script type="text/javascript" src="src/Square.js"></script>
        <script type="text/javascript" src="src/InputController.js"></script>
        <script type="text/javascript" src="src/Layer.js"></script>
        <script type="text/javascript" src="src/LayerController.js"></script>
        <script type="text/javascript" src="src/Cover.js"></script>
        <script type="text/javascript" src="src/SummerCamp.js"></script>
        <script type="text/javascript" src="src/Timer.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    </head>
    <body>
        <div id="title-flex-container">
            <div id="title-inner-container">
                <div id="title-box">Another Day at Summer Camp</div>
                <div id="sub-title">a thing by <a href="http://kevin.4mcveys.com/" id="self-link">Kevin McVey</a></div>
            </div>
        </div>

        <div id="canvas-container"></div>
        <div id="cover-container"></div>
    </body>
    <script>
      // Page setup
      var threeQuartersMargin = window.innerWidth * (3/4) - ($('#title-inner-container').width() / 2)
      $('#title-inner-container').css({ 'margin-left': threeQuartersMargin });
      $('#title-flex-container').fadeOut(10000);

      var layerController = new LayerController('canvas-container');
      var summerCamp = new SummerCamp(layerController, 'cover-container', 10);
      summerCamp.initialize();

      $('#self-link').on('mousemove', function(event) {
        layerController.layers[0].inputController.redraw(event.pageX, event.pageY);
      });

      var timer = new Timer(window);
      $(window).on('tick', function(tickEvent) { console.log(tickEvent.timeMillis) });
      $(window).on('blur', function() { timer.pause() });
      $(window).on('focus', function() { timer.start() });
      //timer.start();


      // Test code below
      //var layer1 = new Layer('canvas-container', 100, 100, undefined, undefined, '#ffcccc', '#ffffff');
      //var layer2 = new Layer('otherCanvas', 300, 300, undefined, undefined, '#ccccff', '#ffffff');
      //var layer3 = new Layer('thirdCanvas', 500, 500, undefined, undefined, '#ccffcc', '#ffffff');
      //var cover = new Cover('cover', layer1.canvasId);
    </script>
</html>